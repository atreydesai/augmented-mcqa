Resolved cached snapshot for Nanbeige/Nanbeige4.1-3B: /fs/nexus-scratch/adesai10/hub/hub/models--Nanbeige--Nanbeige4.1-3B/snapshots/7e64fe9201798df23b4f15906be0c7376d6efc91
=== Local Model Smoke Test ===
Model key: Nanbeige/Nanbeige4.1-3B
Client kwargs: {'gpu_memory_utilization': 0.9, 'tensor_parallel_size': 1, 'model_id': '/fs/nexus-scratch/adesai10/hub/hub/models--Nanbeige--Nanbeige4.1-3B/snapshots/7e64fe9201798df23b4f15906be0c7376d6efc91', 'tokenizer_mode': 'auto'}
Cache root: /fs/nexus-scratch/adesai10/hub
Client created in 0.00s: Local (/fs/nexus-scratch/adesai10/hub/hub/models--Nanbeige--Nanbeige4.1-3B/snapshots/7e64fe9201798df23b4f15906be0c7376d6efc91)
  Applied TokenizersBackend compatibility patch for vLLM
Loading model: /fs/nexus-scratch/adesai10/hub/hub/models--Nanbeige--Nanbeige4.1-3B/snapshots/7e64fe9201798df23b4f15906be0c7376d6efc91
  GPU memory utilization: 0.9
  Tensor parallel size: 1
  Seed: 12345
  Dtype: auto
  Tokenizer mode: auto
INFO 02-20 01:36:04 [utils.py:253] non-default args: {'trust_remote_code': True, 'download_dir': '/fs/nexus-scratch/adesai10/hub', 'seed': 12345, 'disable_log_stats': True, 'model': '/fs/nexus-scratch/adesai10/hub/hub/models--Nanbeige--Nanbeige4.1-3B/snapshots/7e64fe9201798df23b4f15906be0c7376d6efc91'}
INFO 02-20 01:36:04 [model.py:631] Resolved architecture: LlamaForCausalLM
INFO 02-20 01:36:04 [model.py:1745] Using max model len 262144
INFO 02-20 01:36:04 [scheduler.py:216] Chunked prefill is enabled with max_num_batched_tokens=8192.
[1;36m(EngineCore_DP0 pid=20808)[0;0m INFO 02-20 01:36:06 [core.py:93] Initializing a V1 LLM engine (v0.11.2) with config: model='/fs/nexus-scratch/adesai10/hub/hub/models--Nanbeige--Nanbeige4.1-3B/snapshots/7e64fe9201798df23b4f15906be0c7376d6efc91', speculative_config=None, tokenizer='/fs/nexus-scratch/adesai10/hub/hub/models--Nanbeige--Nanbeige4.1-3B/snapshots/7e64fe9201798df23b4f15906be0c7376d6efc91', skip_tokenizer_init=False, tokenizer_mode=auto, revision=None, tokenizer_revision=None, trust_remote_code=True, dtype=torch.bfloat16, max_seq_len=262144, download_dir='/fs/nexus-scratch/adesai10/hub', load_format=auto, tensor_parallel_size=1, pipeline_parallel_size=1, data_parallel_size=1, disable_custom_all_reduce=False, quantization=None, enforce_eager=False, kv_cache_dtype=auto, device_config=cuda, structured_outputs_config=StructuredOutputsConfig(backend='auto', disable_fallback=False, disable_any_whitespace=False, disable_additional_properties=False, reasoning_parser='', reasoning_parser_plugin='', enable_in_reasoning=False), observability_config=ObservabilityConfig(show_hidden_metrics_for_version=None, otlp_traces_endpoint=None, collect_detailed_traces=None), seed=12345, served_model_name=/fs/nexus-scratch/adesai10/hub/hub/models--Nanbeige--Nanbeige4.1-3B/snapshots/7e64fe9201798df23b4f15906be0c7376d6efc91, enable_prefix_caching=True, enable_chunked_prefill=True, pooler_config=None, compilation_config={'level': None, 'mode': <CompilationMode.VLLM_COMPILE: 3>, 'debug_dump_path': None, 'cache_dir': '', 'compile_cache_save_format': 'binary', 'backend': 'inductor', 'custom_ops': ['none'], 'splitting_ops': ['vllm::unified_attention', 'vllm::unified_attention_with_output', 'vllm::unified_mla_attention', 'vllm::unified_mla_attention_with_output', 'vllm::mamba_mixer2', 'vllm::mamba_mixer', 'vllm::short_conv', 'vllm::linear_attention', 'vllm::plamo2_mamba_mixer', 'vllm::gdn_attention_core', 'vllm::kda_attention', 'vllm::sparse_attn_indexer'], 'compile_mm_encoder': False, 'use_inductor': None, 'compile_sizes': [], 'inductor_compile_config': {'enable_auto_functionalized_v2': False, 'combo_kernels': True, 'benchmark_combo_kernel': True}, 'inductor_passes': {}, 'cudagraph_mode': <CUDAGraphMode.FULL_AND_PIECEWISE: (2, 1)>, 'cudagraph_num_of_warmups': 1, 'cudagraph_capture_sizes': [1, 2, 4, 8, 16, 24, 32, 40, 48, 56, 64, 72, 80, 88, 96, 104, 112, 120, 128, 136, 144, 152, 160, 168, 176, 184, 192, 200, 208, 216, 224, 232, 240, 248, 256, 272, 288, 304, 320, 336, 352, 368, 384, 400, 416, 432, 448, 464, 480, 496, 512], 'cudagraph_copy_inputs': False, 'cudagraph_specialize_lora': True, 'use_inductor_graph_partition': False, 'pass_config': {}, 'max_cudagraph_capture_size': 512, 'local_cache_dir': None}
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842] EngineCore failed to start.
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842] Traceback (most recent call last):
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]   File "/fs/nexus-projects/rlab/atrey/qgqa/augmented-mcqa/.venv/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 833, in run_engine_core
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]     engine_core = EngineCoreProc(*args, **kwargs)
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]   File "/fs/nexus-projects/rlab/atrey/qgqa/augmented-mcqa/.venv/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 606, in __init__
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]     super().__init__(
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]   File "/fs/nexus-projects/rlab/atrey/qgqa/augmented-mcqa/.venv/lib/python3.12/site-packages/vllm/v1/engine/core.py", line 102, in __init__
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]     self.model_executor = executor_class(vllm_config)
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]   File "/fs/nexus-projects/rlab/atrey/qgqa/augmented-mcqa/.venv/lib/python3.12/site-packages/vllm/v1/executor/abstract.py", line 101, in __init__
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]     self._init_executor()
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]   File "/fs/nexus-projects/rlab/atrey/qgqa/augmented-mcqa/.venv/lib/python3.12/site-packages/vllm/v1/executor/uniproc_executor.py", line 46, in _init_executor
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]     self.driver_worker.init_worker(all_kwargs=[kwargs])
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]   File "/fs/nexus-projects/rlab/atrey/qgqa/augmented-mcqa/.venv/lib/python3.12/site-packages/vllm/v1/worker/worker_base.py", line 255, in init_worker
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]     worker_class = resolve_obj_by_qualname(
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]                    ^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]   File "/fs/nexus-projects/rlab/atrey/qgqa/augmented-mcqa/.venv/lib/python3.12/site-packages/vllm/utils/import_utils.py", line 89, in resolve_obj_by_qualname
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]     module = importlib.import_module(module_name)
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]   File "/fs/clip-projects/rlab/atrey/miniconda3/lib/python3.12/importlib/__init__.py", line 90, in import_module
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]     return _bootstrap._gcd_import(name[level:], package, level)
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]   File "<frozen importlib._bootstrap>", line 1387, in _gcd_import
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]   File "<frozen importlib._bootstrap>", line 1360, in _find_and_load
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]   File "<frozen importlib._bootstrap>", line 1331, in _find_and_load_unlocked
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]   File "<frozen importlib._bootstrap>", line 935, in _load_unlocked
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]   File "<frozen importlib._bootstrap_external>", line 995, in exec_module
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]   File "<frozen importlib._bootstrap>", line 488, in _call_with_frames_removed
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]   File "/fs/nexus-projects/rlab/atrey/qgqa/augmented-mcqa/.venv/lib/python3.12/site-packages/vllm/v1/worker/gpu_worker.py", line 52, in <module>
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]     from vllm.v1.worker.gpu_model_runner import GPUModelRunner
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]   File "/fs/nexus-projects/rlab/atrey/qgqa/augmented-mcqa/.venv/lib/python3.12/site-packages/vllm/v1/worker/gpu_model_runner.py", line 135, in <module>
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]     from vllm.v1.spec_decode.ngram_proposer import NgramProposer
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]   File "/fs/nexus-projects/rlab/atrey/qgqa/augmented-mcqa/.venv/lib/python3.12/site-packages/vllm/v1/spec_decode/ngram_proposer.py", line 6, in <module>
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]     from numba import get_num_threads, jit, njit, prange, set_num_threads
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]   File "/fs/nexus-projects/rlab/atrey/qgqa/augmented-mcqa/.venv/lib/python3.12/site-packages/numba/__init__.py", line 59, in <module>
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]     _ensure_critical_deps()
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]   File "/fs/nexus-projects/rlab/atrey/qgqa/augmented-mcqa/.venv/lib/python3.12/site-packages/numba/__init__.py", line 45, in _ensure_critical_deps
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842]     raise ImportError(msg)
[1;36m(EngineCore_DP0 pid=20808)[0;0m ERROR 02-20 01:36:08 [core.py:842] ImportError: Numba needs NumPy 2.2 or less. Got NumPy 2.4.
