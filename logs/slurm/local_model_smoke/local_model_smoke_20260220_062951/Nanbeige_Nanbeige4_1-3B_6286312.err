Resolved 82 packages in 100ms
Audited 76 packages in 105ms
Resolved 155 packages in 2.57s
Downloading transformers (11.4MiB)
Downloading numpy (15.8MiB)
 Downloaded numpy
 Downloaded transformers
Prepared 4 packages in 25.95s
Uninstalled 4 packages in 10.83s
Installed 4 packages in 16.25s
 - anthropic==0.79.0
 + anthropic==0.71.0
 - huggingface-hub==1.4.1
 + huggingface-hub==0.36.2
 - numpy==2.4.2
 + numpy==2.2.6
 - transformers==5.1.0
 + transformers==4.57.6
Downloading numpy (15.8MiB)
Downloading transformers (9.8MiB)
 Downloaded numpy
 Downloaded transformers
Uninstalled 4 packages in 8.91s
Installed 4 packages in 12.21s
The argument `trust_remote_code` is to be used with Auto classes. It has no effect here and is ignored.
Traceback (most recent call last):
  File "/fs/nexus-projects/rlab/atrey/qgqa/augmented-mcqa/scripts/smoke_local_model.py", line 134, in <module>
    raise SystemExit(main())
                     ^^^^^^
  File "/fs/nexus-projects/rlab/atrey/qgqa/augmented-mcqa/scripts/smoke_local_model.py", line 108, in main
    result = client.generate(
             ^^^^^^^^^^^^^^^^
  File "/fs/nexus-projects/rlab/atrey/qgqa/augmented-mcqa/models/local_client.py", line 170, in generate
    results = self.generate_batch([prompt], max_tokens, **kwargs)
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/fs/nexus-projects/rlab/atrey/qgqa/augmented-mcqa/models/local_client.py", line 187, in generate_batch
    self._ensure_loaded()
  File "/fs/nexus-projects/rlab/atrey/qgqa/augmented-mcqa/models/local_client.py", line 128, in _ensure_loaded
    self._llm = LLM(**llm_kwargs)
                ^^^^^^^^^^^^^^^^^
  File "/fs/nexus-projects/rlab/atrey/qgqa/augmented-mcqa/.venv/lib/python3.12/site-packages/vllm/entrypoints/llm.py", line 343, in __init__
    self.llm_engine = LLMEngine.from_engine_args(
                      ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/fs/nexus-projects/rlab/atrey/qgqa/augmented-mcqa/.venv/lib/python3.12/site-packages/vllm/v1/engine/llm_engine.py", line 174, in from_engine_args
    return cls(
           ^^^^
  File "/fs/nexus-projects/rlab/atrey/qgqa/augmented-mcqa/.venv/lib/python3.12/site-packages/vllm/v1/engine/llm_engine.py", line 89, in __init__
    tokenizer = init_tokenizer_from_configs(self.model_config)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/fs/nexus-projects/rlab/atrey/qgqa/augmented-mcqa/.venv/lib/python3.12/site-packages/vllm/transformers_utils/tokenizer.py", line 287, in init_tokenizer_from_configs
    return get_tokenizer(
           ^^^^^^^^^^^^^^
  File "/fs/nexus-projects/rlab/atrey/qgqa/augmented-mcqa/.venv/lib/python3.12/site-packages/vllm/transformers_utils/tokenizer.py", line 257, in get_tokenizer
    tokenizer = get_cached_tokenizer(tokenizer)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/fs/nexus-projects/rlab/atrey/qgqa/augmented-mcqa/.venv/lib/python3.12/site-packages/vllm/transformers_utils/tokenizer.py", line 92, in get_cached_tokenizer
    tokenizer_all_special_tokens_extended = tokenizer.all_special_tokens_extended
                                            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/fs/nexus-projects/rlab/atrey/qgqa/augmented-mcqa/.venv/lib/python3.12/site-packages/transformers/tokenization_utils_base.py", line 1291, in __getattr__
    raise AttributeError(f"{self.__class__.__name__} has no attribute {key}")
AttributeError: TokenizersBackend has no attribute all_special_tokens_extended. Did you mean: 'num_special_tokens_to_add'?
